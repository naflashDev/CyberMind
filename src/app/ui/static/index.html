<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>CYBERMIND</title>
  <link rel="icon" type="image/x-icon" href="/ui/images/CyberMindLogo.ico">
  <link rel="stylesheet" href="/ui/styles.css">
  <!-- Markdown parser (marked) -->
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>

<body>
  <!-- Bot√≥n fijo para mostrar/ocultar la sidebar -->
  <div class="toggle-wrapper">
    <button class="toggle-sidebar" id="btn-toggle">&laquo;</button>
  </div>

  <!-- SIDEBAR -->
  <aside class="sidebar" id="sidebar" style="display:flex; flex-direction:column; justify-content:space-between; height:100vh;">
    <div>
      <h1>CyberMind</h1>
      <button class="nav-button active" data-view="fastapi" id="btn-fastapi"><span style="margin-right:6px;">‚ö°</span>Operaciones FastAPI</button>
      <button class="nav-button" data-view="datos" id="btn-datos"><span style="margin-right:6px;">üìä</span>Datos</button>
      <button class="nav-button" data-view="tiny" id="btn-tiny"><span style="margin-right:6px;">üì∞</span>Noticias Tiny</button>
      <button class="nav-button" data-view="llm" id="btn-llm"><span style="margin-right:6px;">ü§ñ</span>CyberSentinel IA</button>
      <button class="nav-button" data-view="docs" id="btn-docs"><span style="margin-right:6px;">üìö</span>Documentaci√≥n</button>
      <button class="nav-button" data-view="coverage" id="btn-coverage"><span style="margin-right:6px;">üß™</span>Cobertura</button>
      <button class="nav-button" data-view="config" id="btn-config"><span style="margin-right:6px;">‚öôÔ∏è</span>Configuraci√≥n</button>
    </div>
    <div style="text-align:center; margin-bottom:18px;">
      <a href="https://github.com/naflashDev" target="_blank" rel="noopener" style="display:inline-block;">
          <img src="/ui/images/CyberMindLogo.webp" alt="CyberMind Logo" style="width:120px; height:auto; display:block; margin:0 auto 6px auto;" />
      </a>
      <div style="color:#b0b3b8; font-size:13px;">¬© CyberMind 2026</div>
    </div>
  </aside>
      <!-- Vista: Cobertura de tests (coverage) -->
      <div class="view" id="view-coverage" style="display:none;">
        <div style="height:100%; width:100%; display:flex; flex-direction:column; align-items:center; justify-content:center;">
          <h2 style="color:#e5e7eb; margin-bottom:12px;">Cobertura de tests</h2>
          <iframe id="coverage-iframe" src="/coverage/html" style="width:90vw; height:80vh; border:1px solid #222; background:#fff; border-radius:8px; box-shadow:0 2px 8px #0002;"></iframe>
          <div style="color:#b0b3b8; font-size:13px; margin-top:8px;">El reporte se genera tras ejecutar los tests en CI o localmente.</div>
        </div>
      </div>
      <!-- Vista: Documentaci√≥n del proyecto (en main-content, no en sidebar) -->
      <div class="view" id="view-docs">
        <div style="display:flex; height:100%;">
          <div class="docs-list-pane" style="width:220px; background:#181f2a; color:#e5e7eb; padding:12px; box-sizing:border-box; overflow-y:auto; display:block;">
            <h3 style="margin-top:0;">Documentos</h3>
            <ul id="docs-list" style="list-style:none; padding:0; margin:0;"></ul>
          </div>
          <div class="docs-content-pane" style="flex:1; padding:16px; overflow:auto; background:#0b0f13;">
            <div id="docs-content" style="max-width:900px; margin:auto; background:#181f2a; color:#e5e7eb; border-radius:8px; padding:24px; min-height:80vh; box-shadow:0 2px 8px #0002;"></div>
          </div>
        </div>
      </div>

  <!-- MAIN -->
  <div class="main">
    <div class="main-content">
      <!-- Vista: Configuraci√≥n editable de archivos .ini -->
      <div class="view" id="view-config" style="display:none;">
        <div class="config-panel">
          <h2 class="config-title">Configuraci√≥n del sistema</h2>
          <div id="config-files"></div>
          <div class="config-actions">
            <button id="btn-save-config" class="config-btn-save">Guardar</button>
            <button id="btn-discard-config" class="config-btn-discard">Descartar</button>
            <span id="config-status" class="config-status"></span>
          </div>
        </div>
      </div>
      <!-- Vista: FastAPI - Operaciones de los controllers -->
      <div class="view active" id="view-fastapi">
        <div style="display:flex; height:100%;">
          <!-- Left: controllers list inside the fastapi view -->
          <div class="controllers-pane">
            <h3>Services</h3>
            <div id="controllers-list"></div>
          </div>

          <!-- Right: operation form and result -->
          <div class="op-area" style="flex:1; padding:12px; box-sizing:border-box; display:flex; flex-direction:column;">
            <div style="margin-bottom:8px; display:flex; align-items:center; justify-content:space-between;">
              <h3 id="op-title" style="margin:0;">Seleccione una operaci√≥n</h3>
              <div style="font-size:13px; color:#6b7280;">FastAPI API: <code>http://127.0.0.1:8000</code></div>
            </div>

            <div id="op-form" style="margin-bottom:12px;">
              <p style="color:#6b7280;">Seleccione una operaci√≥n en la izquierda para ver los par√°metros y ejecutarla.</p>
            </div>

            <div style="flex:1; overflow:auto;">
              <div id="op-result" style="display:none; background:#0b1220; color:#e6eef8; padding:12px; border-radius:6px; box-sizing:border-box;"></div>
            </div>
          </div>
        </div>
      </div>

      <div class="view" id="view-datos">
        <div class="iframe-placeholder" data-src="http://127.0.0.1:5601/">
          <button class="load-iframe-btn">Cargar OpenSearch Dashboards</button>
        </div>
      </div>

      <!-- Vista: Noticias Tiny (Tiny RSS en 127.0.0.1:8280/tt-rss/) -->
      <div class="view" id="view-tiny">
        <div class="iframe-placeholder" data-src="http://127.0.0.1:8280/tt-rss/">
          <button class="load-iframe-btn">Cargar Tiny Tiny RSS</button>
        </div>
      </div>

      <!-- Vista LLM full-size -->
      <div class="view" id="view-llm">
        <div id="llm-panel">
          <h2>LLM Console (Cyberintelligence)</h2>
          <p>Interact√∫a con el modelo local (llama3 en Ollama) para consultar CVE y noticias procesadas.</p>
          <div id="llm-messages"></div>
          <div id="llm-input-row">
            <input id="llm-prompt" type="text"
              placeholder="Escribe tu pregunta al LLM (por ejemplo, explica un CVE o resume una noticia)..." />
            <button id="llm-send-btn">Enviar</button>
          </div>
        </div>
      </div>
      <!-- Vista: Estado del sistema -->
      <div class="view" id="view-status">
        <div style="padding:16px; box-sizing:border-box; height:100%; display:flex; flex-direction:column; gap:12px;">
          <h2>Estado del sistema</h2>
          <div style="display:flex; gap:8px; align-items:center;">
            <button id="btn-refresh-status-view" style="padding:8px 12px; border-radius:6px; border:none; background:#2563eb; color:#fff; cursor:pointer;">Actualizar</button>
            <div id="status-summary" style="color:#9aa6b2;">Cargando estado...</div>
          </div>
          <div style="flex:1; overflow:auto;">
            <pre id="status-json" style="background:#0b1220; color:#e6eef8; padding:12px; border-radius:6px; white-space:pre-wrap;">Cargando...</pre>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- External UI logic -->
  <script src="/ui/ui.js"></script>
</body>

</html>